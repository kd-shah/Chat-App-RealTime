<div class="chat">
    <div class="no-conversation-message" *ngIf="!messagesFound">
        No conversation found.
    </div>

    <div class="user-chat" *ngIf="messagesFound" #userChat (scroll)="onScroll(userChat)">

        <div *ngFor="let eachMessage of messages" class="messages">
            <div *ngIf="!eachMessage.isFile" class="text-chat">
                <li *ngIf="eachMessage.isEditing==false" (contextmenu)="openContextMenu($event, eachMessage)"
                    [ngClass]="['message-block', eachMessage.senderId == loggedInUserId ? 'sentClass' : 'receivedClass']">

                    {{eachMessage.content}}

                </li>
            </div>
            <div *ngIf="eachMessage.isFile" class="text-chat">
                <li [ngClass]="['file-block', eachMessage.senderId == loggedInUserId ? 'sentClass' : 'receivedClass']">

                    <div [ngSwitch]="eachMessage.contentType">
                        <!-- <img *ngSwitchCase="'image/png'" src="" alt="Image"> -->
                        <div>{{eachMessage.fileName}}</div>
                        <div>{{eachMessage.caption}}</div>
                    </div>

                </li>
            </div>

            <li *ngIf="eachMessage.isEditing==true"
                [ngClass]="['message-block', eachMessage.senderId == loggedInUserId ? 'sentClass' : 'receivedClass']">

                <form [formGroup]="editForm">
                    <input formControlName="editedMessage" class="editInput">
                    <button type="submit" (click)="onSaveChanges()" class="optionButton">
                        Save
                    </button>

                    <button (click)="onCancelChanges()" class="optionButton">
                        Cancel
                    </button>
                </form>
            </li>
        </div>

        <div *ngIf="contextMenuVisible" [style.left.px]="contextMenuX" [style.top.px]="contextMenuY"
            class="context-menu">


            <li (click)="onEditMessage()" class="option">Edit</li>
            <li (click)="onDeleteMessage()" class="option">Delete</li>

        </div>

    </div>
    <div *ngFor = "let file of selectedFiles" class="selectedFiles">
            {{file.name}}
            <button (click) = "onDelete()">Cancel</button> 
    </div>
    <form class="message-box" [formGroup]="sendForm">
        <input placeholder="Message" class="message" formControlName="message">
        <button id="attachButton" (click)="attachFile()" >Attach</button>
        <input type="file" #fileInput id="fileInput" class="file-attach" formControlName="message" (change)="onFileSelected($event)" accept=".jpg, .png">
        <button type="submit" (click)="onSendMessage()" class="sendButton">Send</button>
    </form>
    

</div>